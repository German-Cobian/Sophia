<div class="border border-dark my-5 mx-5">
  <div class="my-3 mx-5">
  
    <div class="d-flex flex-row justify-content-start">
      <%= image_tag( @article.image, height: 120, width: 120, class: "me-5" ) if @article.image.attached? %> 
      <div class="mt-3">
        <strong class="me-4"><%= @article.title %></strong>
        <small><%= @article.category.topic%></small>
        <div class="d-flex flex-row justify-content-start mt-3">
          <p class="me-3"><strong>By: </strong></p>
          <%= image_tag( @article.creator.avatar, height: 30, width: 30, class: "rounded-circle" ) if @article.creator.avatar.attached?%>
          <p class="ms-2"><%= @article.creator.username %><p>
        </div>
      </div>
    </div>

    <div class="mt-5">
      <%= @article.body %>
    </div>

    <div class="d-flex flex-row mt-3">
      <div class="mt-1">
        <span><strong>Votes: </strong><%= @article.votes.count %></span>
      </div>
      <% if current_user %>
        <% vote = current_user.votes.find_by(article: @article) %>
        <% if vote.nil? %>
          <%= button_to "Upvote", votes_path, params: { vote: {:article_id => @article.id } }, method: :post, class: "btn btn-outline-primary py-0 ms-5" %>
        <% else %>
          <%= button_to "Downvote", vote_path(vote), method: :delete, class: "btn btn-outline-primary py-0 ms-5" %>
        <% end %>
      <% end %>
    </div>

    <% if current_user %>
      <div>
        <%= render '/comments/show' %>
      </div>
      <div>
        <%= render '/comments/form' %>
      </div>
      <% if  @article.creator == current_user || current_user.admin? %>
        <div class="d-flex flex-row justify-content-end mt-2">
          <div class="pt-2 me-5">
            <%= link_to "Edit Article", edit_article_path(@article), class: "" %>
          </div>
          <div>
            <%= button_to "Delete Article", article_path(@article), method: :delete, class:"btn btn-outline-danger py-0 me-5"%>
          </div>
        </div>
      <% end %>
    <% end %>

    <div class="mt-3">
      <%= link_to 'Back', categories_path %>
    </div>

  </div>
</div>
